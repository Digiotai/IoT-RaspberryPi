Setting up rpivideo.py file:


from datetime import datetime
from time import sleep
import picamera
import os
import boto3
import time
n=0

while n<5: 
    # camera setup
    camera = picamera.PiCamera()
    timestr = time.strftime("%Y%m%d-%H%M%S")

    # camera warm-up time
    sleep(2)


    # Record Video
    camera.start_recording('video'+ timestr + '.h264')
    sleep(10)
    camera.stop_recording()
    
    print('video successfully recorded')

    # Upload to S3 at the edge device
    s3 = boto3.client('s3')
    filename ='video'+ timestr + '.h264' 
    bucket_name = 'rpm-video-digiotai'
    s3.upload_file(filename,bucket_name,filename)
    print('video uploaded to aws s3')
    camera.close()
    sleep(1)
    print (n)
    n=n+1
    
    
